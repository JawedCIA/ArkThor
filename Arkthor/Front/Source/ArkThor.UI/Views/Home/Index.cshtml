@{
    ViewData["Title"] = "Home Page";
    Layout = "~/Views/Shared/_Layout.cshtml";
    <!--Reload the page at regular Interval-->
    @*<meta http-equiv="refresh" content="60">*@
    <!-- Tell the browser to be responsive to screen width -->
    @*<meta name="viewport" content="width=device-width, initial-scale=1">*@
    <!-- Theme style -->
    <link rel="stylesheet" href="~/theme/dist/css/adminlte.min.css">
      <!-- Toastr -->
  <link rel="stylesheet" href="~/theme/plugins/toastr/toastr.min.css">

}

@section scripts {
            

    <!-- Bootstrap 4 -->
    <script src="~/theme/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>


    <!-- bs-custom-file-input -->
    <script src="~/theme/plugins/bs-custom-file-input/bs-custom-file-input.min.js"></script>

    <script type="text/javascript">
        'use strict';

        $(document).ready(function () {
            bsCustomFileInput.init();
            getTopThreatOperation();
            getDashboardCountValues();
          //  dynamicAPIURL();
        });       
  

    </script>
}


<div class="wrapper">

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <div class="content-header">
            <div class="container-fluid">
                <div class="row mb-2">
                    <div class="col-sm-6">
                        <h1 class="m-0 text-dark">Dashboard </h1>
                    </div><!-- /.col -->
                    <div class="col-sm-6">
                        <ol class="breadcrumb float-sm-right">
                            <li class="breadcrumb-item"><a href="#">Home</a></li>
                            <li class="breadcrumb-item active">ArkThor Dashboard</li>
                        </ol>
                    </div><!-- /.col -->
                </div><!-- /.row -->
            </div><!-- /.container-fluid -->
        </div>
        <!-- /.content-header -->
        <!-- Main content -->
        <section class="content">
            <div class="container-fluid">
                <!-- Small boxes (Stat box) -->
                <div class="row">
                    <div class="col-lg-3 col-6">
                        <!-- small box -->
                        <div class="small-box bg-info">
                            <div class="inner">
                                <h3 id="h3Queued">0</h3>
                              <!-- <p>Release Request (New/Total)</p> -->
                                 <span class="info-box-text">#File Queued</span>
                                 <!--<span class="info-box-text">2022-01-01 to 2022-01-01</span>-->                               
                                <!-- <span class="info-box-text"></span>-->
                            </div>
                           
                            <div class="icon">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <a href="/Home/Statistics" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                        </div>
                            </div>
                   
                    <!-- ./col -->
                    <div class="col-lg-3 col-6">
                        <!-- small box -->
                        <div class="small-box bg-success">
                            <div class="inner">
                                <h3 id="h3FileSubmitted">0@*<sup style="font-size: 20px"></sup>*@</h3>
                                
                                 <span class="info-box-text">#File Submitted</span>                            
                                
                            </div>
                            <div class="icon">
                                <i class="fas fa-paper-plane"></i>
                            </div>
                            <a href="/Home/Statistics" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                    <!-- ./col -->
                    <div class="col-lg-3 col-6">
                        <!-- small box -->
                        <div class="small-box bg-gradient-blue">
                            <div class="inner">
                                <h3 id="h3FileAnalyzed">0</h3>
                                 <span class="info-box-text">#File Analyzed</span>                            
                               
                               
                            </div>
                            <div class="icon">
                                <i class="fas fa-rocket"></i>
                            </div>
                            <a href="/Home/Statistics" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                    <!-- ./col -->
                    <!-- ./col -->
                    <div class="col-lg-3 col-6">
                        <!-- small box -->
                        <div class="small-box bg-danger">
                            <div class="inner">
                                <h3 id="h3TC">0</h3>
                               
                                <span class="info-box-text">#Threat Categorizes</span>
                            </div>
                            <div class="icon">
                                <!--<i class="fas fa-pie-chart"></i>-->
                                <i class="nav-icon fas fa-chart-pie"></i>
                            </div>
                            <a href="/Home/Statistics" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                        </div>
                    </div>


                    <!-- ./col -->

                </div>
                <!-- /.row -->
         

                <!--Maintenance Windows Current Week-->
                <div class="row" id="divDashboardUplaodFilesAndSearch">
                    <div class="col-md-12">
                                         
                        <div class="card card-info card-outline">
                            <div class="card-header">
                            
                                <h3 class="card-title">  <i class="fas fa-rocket"></i> Threat Categorization </h3>

                                <div class="card-tools">
                               
                                    <button type="button" class="btn btn-tool" data-card-widget="collapse">
                                        <i class="fas fa-minus"></i>
                                    </button>

                                </div>
                               
                            </div>
                            <!-- /.card-header -->
                            <div class="card-body p-0">
                                 <div class="card card-info card-tabs">
                            <div class="card-header p-0 pt-1">                            
                            
                                 <ul class="nav nav-tabs" id="custom-tabs" role="tablist">
                                   <li class="nav-item">
                                                <a class="nav-link active" id="custom-tabs-tab-one" data-toggle="pill" href="#custom-tabs-file" role="tab" aria-controls="custom-tabs-file" aria-selected="true"> <i class="fas fa-upload"></i> File(s) </a>
                                            </li>
                                 <!-- <li class="nav-item">
                                    <a class="nav-link active" id="custom-tabs-tab-two" data-toggle="pill" href="#custom-tabs-files" role="tab" aria-controls="custom-tabs-files" aria-selected="false"> <i class="fas fa-upload"></i>
                                    File Collection</a>
                                  </li>-->
                                
                                   <li class="nav-item">
                                                <a class="nav-link" id="custom-tabs-tab-three" data-toggle="pill" href="#custom-tabs-search" role="tab" aria-controls="custom-tabs-search" aria-selected="false"><i class="fas fa-search"></i>Threat Search</a>
                                    </li>
                 
                                </ul>
                            </div>
                            <!-- /.card-header -->
                            <div class="card-body p-0">
                              
                                 <div class="tab-content" id="custom-tabs-one-tabContent">
                                    
                                            <div class="tab-pane fade show active" id="custom-tabs-file" role="tabpanel" aria-labelledby="custom-tabs-file">
                                            
                                                <!--<div class="card-body">
                                                    <div class="form-group row">-->
                                              <div class="col-12">
                                                        <br/>
                                                        <h6>
                                                        This is a <b>Threat Categorization</b> engine (ArkThor) based on <b>Malware's C2 Communication</b> of uploaded <b>pacp</b> file, <b> Created and developed by Group-6 (Cohort-6, 2022-2023) of IITK CSCD program.</b><br />
                                                        </h6>
                                                           <br/>
                                              </div>
                                               <div class="col-6">
                                                    <form method="post" asp-route="Home/UploadFiles" enctype="multipart/form-data">
                                                
                                                            <div class="input-group">
                                                            
                                                                <div class="custom-file">
                                                                <input type="file" class="custom-file-input" id="files" name="files" required>
                                                                    <label class="custom-file-label" for="lblInputFile" data-browse="Choose">Select pcap file (Max.Size limit - 50 MB)</label>
                                                                </div>
                                                                    <!--<div class="input-group-append"> asp-action="Index" asp-controller="Home" asp-controller="Home" asp-action="UploadFiles"
                                                                    <div class="input-group-text"><i class="fa fa-paperclip lowprio"></i></div>
                                                                </div>-->
                                                                <div class="input-group-append">
                                                                    <!--<span class="input-group-text" id="">Upload</span> <i class="fa fa-paperclip lowprio" aria-hidden="true"> </i>-->
                                                            <button type="submit" class="btn btn-primary">Analyze</button>
                                                                </div>
                                                      
                                                            </div>
                                                            <br/>                                                
                                                          
                                                    </form>
                                              </div>
                                                <div id="divResponse">

                                                    @if (ViewBag.Message != null)
                                                    {
                                                        @if (ViewBag.Message.Contains("SUCCESS"))
                                                        {
                                                            <div class="card-success" style="margin-top:20px">
                                                                <p class="text-success"> @ViewBag.Message</p>

                                                            </div>
                                                        }
                                                        else
                                                        {
                                                            <div class="card-danger" style="margin-top:20px">
                                                                <p class="text-danger"> @ViewBag.Message</p>
                                                            </div>
                                                        }
                                                    }

                                                </div>
                                                <!-- </div>
                                                </div>-->                                           
                                                
                                              
                                           
                                            </div> 
                                      
                                          
                                            <div class="tab-pane fade" id="custom-tabs-search" role="tabpanel" aria-labelledby="custom-tabs-search">
                                              
                                            </div>
         
                                 </div>
                                      
                                <!--Dynamic Generated Table using JS- Check ArkThor.js-->
                            </div>
                            <!-- /.card-body -->
               
                        </div>
                            </div>
                            <!-- /.card-body -->
                            <!-- /.card-footer -->
                            <div class="card-footer clearfix">
                                <ul class="pagination pagination-sm m-0 float-right">
                                    <li class="page-item">  <a href="/Home/LiveAnalysisTracking" class="small-box-footer" target="_blank">Track Live Analysis <i class="fas fa-arrow-circle-right"></i></a></li>
                                </ul>                              
                                <a href="/Home/Subscribe" class="float-left"><i class="fas fa-bell"> Subscribe</i></a>
                            </div>
                        </div>
                    </div>
                </div>
                                           <!-- In One Point Highlight -->
             

             <!--Release Team for Last Week, Current Week and Next Week-->
                <div class="row" id="divCurrentAnalyze">
                   
                             <!-- Announcement-->
                    <section class="col-lg-12 connectedSortable">
                        <!--Announcement-->
                        <div class="card direct-chat direct-chat-primary card-danger card-outline">
                            <div class="card-header">
                                <h3 class="card-title">Threat Categorization Analyses based on C2 Communication (Top 10 Records)</h3>

                                <div class="card-tools">

                                    <button type="button" class="btn btn-tool" data-card-widget="collapse">
                                        <i class="fas fa-minus"></i>
                                    </button>

                                </div>
                            </div>
                            <!-- /.card-header -->
                            <div class="card-body">
                             <!--Dynamically Generated Table from DB using JS-->
                                <!--In case No Results found-->
                                <div id="divNoAnalyizeFound" style="display:none">
                                    <h5 style="text-align: center;"><i class="icon fas fa-exclamation-triangle"></i> Alert!</h5>
                                    <h5 style="text-align: center;"> No Record Found for Current Week, Kindly Upload pcap file to start Threat Categorization !!!</h5>
                                </div>
                                <div class="card-footer card-comments" id="divDashboardCardcomments">
                                    <table id="tblReleaseSummaryCurrentWeek" class="table table-striped table-bordered table-sm" style="table-layout:fixed">
                                        <thead align="center">
                                            <tr>
                                                <!--<th style="width:4%">ID</th>-->
                                                <th style="width:5%">ID</th>
                                                <th style="width:25%">SHA-256</th>
                                                <th style="width:15%">FileName</th>
                                                <th style="width:10%">Uploaded Date</th>                                                
                                                <th>Status</th>
                                                <th>Threat Category</th>
                                               <th>Analysis Date </th>
                                              <!--  <th>Uploaded By</th>-->
                                                <th>Current Stage</th>
                                                <th style="text-align:center;width:4%"></th>
                                            </tr>
                                        </thead>
                                        <tbody id="tblTbodyFileSummaryCurrent">
                                            <tr>
                                                <td colspan="8" id="trCurrentNoRecordFound"> No Analyses Record Found... <a href="~/Home/ManageSubscriptions"><i class="fas fa-bell"> Subscribe</i></a> to get Analysis notification in your in-box.</td>

                                            </tr>
                                            <!-- Dynamically Generated -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <!-- /.card-body -->
                            <div class="card-footer clearfix">
                                <ul class="pagination pagination-sm m-0 float-right">
                                    <li class="page-item">  <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                                    
                                    </li>
                                    
                                </ul>
                                <a href="~" class="float-left"><i class="fas fa-bell"> Subscribe</i></a>
                              
                            </div>
                            <!-- /.card-footer-->
                        </div>

                        <!-- /.card -->
                                            
                    </section>
                </div>
  
              
            </div><!-- /.container-fluid -->
   

        </section>

        <!-- /.content -->
    </div>


    <!-- Control Sidebar -->
    <aside class="control-sidebar control-sidebar-dark">
        <!-- Control sidebar content goes here -->
    </aside>
    <!-- /.control-sidebar -->
</div>
<!-- ./wrapper -->